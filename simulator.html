<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pandemic Simulator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        #canvas {
            height: 50vh;
            width: 50vw;
            border: 1px solid rgba(70, 70, 70, 0.226);
        }

        .dot {
            height: 6px;
            width: 6px;
            border: 1px solid rgb(128, 128, 128);
            border-radius: 50%;
            position: absolute;

        }
    </style>
</head>

<body onload="main()">
    <a href="input.html">&larr; Back</a>
    <h1>Pandemic Simulator</h1>

    <p id="info" class="text">Day 1</p>
    <div id="canvas"></div>
    <canvas id="barChart" class="bars"></canvas>
    <canvas id="lineChart"></canvas>
    <canvas id="doughnutChart"></canvas>

    <button onclick="start()">Start</button>
    <button onclick="stop()">Stop</button>
    <button onclick="pause()">Pause</button>


    <table>
        <thead>
            <tr>
                <th></th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Population</td>
                <td id="population" title="Total population"></td>
            </tr>
            <tr>
                <td>Recovery</td>
                <td id="recovery" title="Number of recovered individuals"></td>
            </tr>
            <tr>
                <td>Infected</td>
                <td id="infected" title="Number of infected individuals"></td>
            </tr>
            <tr>
                <td>Immunity</td>
                <td id="immunity" title="Number of immune individuals"></td>
            </tr>
            <tr>
                <td>One Shot</td>
                <td id="oneShot" title="Number of individuals with one vaccine shot"></td>
            </tr>
            <tr>
                <td>Two Shot</td>
                <td id="twoShot" title="Number of individuals with two vaccine shots"></td>
            </tr>
            <tr>
                <td>Dead</td>
                <td id="dead" title="Number of individuals that has died"></td>
            </tr>
        </tbody>
    </table>
    <table>
        <thead>
            <tr>
                <th></th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Population</td>
                <td id="populationPercent" title="Percentage of total population"></td>
            </tr>
            <tr>
                <td>Immunity %</td>
                <td id="immunityPercent" title="Percentage of immune individuals"></td>
            </tr>
            <tr>
                <td>One Shot %</td>
                <td id="oneShotPercent" title="Percentage of individuals with one vaccine shot"></td>
            </tr>
            <tr>
                <td>Two Shot %</td>
                <td id="twoShotPercent" title="Percentage of individuals with two vaccine shots"></td>
            </tr>
            <tr>
                <td>Recovery %</td>
                <td id="recoveryPercent" title="Percentage of recovered individuals"></td>
            </tr>
            <tr>
                <td>Infected %</td>
                <td id="infectedPercent" title="Percentage of infected individuals"></td>
            </tr>
            <tr>
                <td>Dead %</td>
                <td id="deadPercent" title="Percentage of dead individuals"></td>
            </tr>
        </tbody>
    </table>

    <table>
        <thead>
            <tr>
                <th>Input</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Population</td>
                <td id="populationInput" title="Input population value"></td>
            </tr>
            <tr>
                <td>Immunity %</td>
                <td id="immunityInput" title="Input immunity percentage"></td>
            </tr>
            <tr>
                <td>One Shot %</td>
                <td id="oneShotInput" title="Input one shot percentage"></td>
            </tr>
            <tr>
                <td>Two Shot %</td>
                <td id="twoShotInput" title="Input two shot percentage"></td>
            </tr>
            <tr>
                <td>Recovery %</td>
                <td id="recoveryInput" title="Input recovery percentage"></td>
            </tr>
            <tr>
                <td>Infected %</td>
                <td id="infectedInput" title="Input infected percentage"></td>
            </tr>
        </tbody>
    </table>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="chart.js"></script>
    <script src="barGraph.js"></script>
    <script src="lineGraph.js"></script>
    <script src="pieChart.js"></script>
    <script>
        var id;
        var day = 1;
        var isStart = false;

        function stop() {
            clearInterval(id);
            isStart = false;
        }

        function pause() {
            clearInterval(id);
            isStart = false;
        }

        function start() {
            if (!isStart) {
                isStart = true;

                id = setInterval(() => {
                    if (day >= WEEKS * 7) {
                        stop()
                        console.log("Interval has been cleared.");
                        console.log(temp);

                    }

                    updateSimulation();
                    setPercentAttribute()
                    setAttribute()
                    const dataForDays = getDatasetData();


                    document.getElementById("info").innerHTML = "Day " + day;
                    updateBarGraph(dataForDays);
                    updateLineChart(dataForDays, day);
                    updatePieChart(getPercentDataSet())


                    day++;
                }, TIME);
            }
        }


        setTimeout(() => {

            start();
            createBarGraph(getDatasetData())
            createLineChart(getDatasetData())
            createPieChart(getPercentDataSet());
        }, 2000);

    </script>
</body>

</html>